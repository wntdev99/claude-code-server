# 3.4 UI 구현 가이드

## 목적

화면 UI와 사용자 인터랙션을 구현합니다.

---

## 입력

- `result/design/01_screen.md`
- `result/development/03_logic.md`

---

## 작업 항목

### 1. 공통 UI 컴포넌트

```typescript
// src/components/ui/Button.tsx
import { forwardRef, type ButtonHTMLAttributes } from 'react';
import { cva, type VariantProps } from 'class-variance-authority';
import { cn } from '@/lib/utils/cn';
import { Loader2 } from 'lucide-react';

const buttonVariants = cva(
  'inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none',
  {
    variants: {
      variant: {
        primary: 'bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500',
        secondary: 'bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500',
        outline: 'border border-gray-300 bg-white hover:bg-gray-50 focus:ring-primary-500',
        ghost: 'hover:bg-gray-100 focus:ring-gray-500',
        danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-500',
      },
      size: {
        sm: 'h-8 px-3 text-sm',
        md: 'h-10 px-4 text-sm',
        lg: 'h-12 px-6 text-base',
      },
    },
    defaultVariants: {
      variant: 'primary',
      size: 'md',
    },
  }
);

interface ButtonProps
  extends ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  isLoading?: boolean;
}

export const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, isLoading, children, disabled, ...props }, ref) => {
    return (
      <button
        ref={ref}
        className={cn(buttonVariants({ variant, size }), className)}
        disabled={disabled || isLoading}
        {...props}
      >
        {isLoading && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
        {children}
      </button>
    );
  }
);

Button.displayName = 'Button';
```

```typescript
// src/components/ui/Input.tsx
import { forwardRef, type InputHTMLAttributes } from 'react';
import { cn } from '@/lib/utils/cn';

interface InputProps extends InputHTMLAttributes<HTMLInputElement> {
  label?: string;
  error?: string;
  hint?: string;
}

export const Input = forwardRef<HTMLInputElement, InputProps>(
  ({ className, label, error, hint, id, ...props }, ref) => {
    const inputId = id || label?.toLowerCase().replace(/\s/g, '-');

    return (
      <div className="w-full">
        {label && (
          <label
            htmlFor={inputId}
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            {label}
          </label>
        )}
        <input
          ref={ref}
          id={inputId}
          aria-invalid={error ? 'true' : 'false'}
          aria-describedby={error ? `${inputId}-error` : hint ? `${inputId}-hint` : undefined}
          className={cn(
            'w-full px-4 py-2 border rounded-lg text-gray-900 placeholder-gray-400',
            'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent',
            'disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed',
            error ? 'border-red-500' : 'border-gray-300',
            className
          )}
          {...props}
        />
        {hint && !error && (
          <p id={`${inputId}-hint`} className="mt-1 text-sm text-gray-500">{hint}</p>
        )}
        {error && (
          <p id={`${inputId}-error`} className="mt-1 text-sm text-red-600" role="alert">{error}</p>
        )}
      </div>
    );
  }
);

Input.displayName = 'Input';
```

```typescript
// src/components/ui/Card.tsx
import { cn } from '@/lib/utils/cn';
import type { HTMLAttributes } from 'react';

interface CardProps extends HTMLAttributes<HTMLDivElement> {
  padding?: 'none' | 'sm' | 'md' | 'lg';
}

export function Card({ className, padding = 'md', children, ...props }: CardProps) {
  const paddingClasses = {
    none: '',
    sm: 'p-3',
    md: 'p-4',
    lg: 'p-6',
  };

  return (
    <div
      className={cn(
        'bg-white rounded-lg border border-gray-200 shadow-sm',
        paddingClasses[padding],
        className
      )}
      {...props}
    >
      {children}
    </div>
  );
}
```

```typescript
// src/components/ui/LoadingSpinner.tsx
import { cn } from '@/lib/utils/cn';

interface LoadingSpinnerProps {
  size?: 'sm' | 'md' | 'lg';
  className?: string;
}

export function LoadingSpinner({ size = 'md', className }: LoadingSpinnerProps) {
  const sizeClasses = {
    sm: 'h-4 w-4 border-2',
    md: 'h-8 w-8 border-4',
    lg: 'h-12 w-12 border-4',
  };

  return (
    <div
      className={cn(
        'animate-spin rounded-full border-primary-500 border-t-transparent',
        sizeClasses[size],
        className
      )}
    />
  );
}
```

```typescript
// src/components/ui/ErrorView.tsx
import { AlertCircle } from 'lucide-react';
import { Button } from './Button';

interface ErrorViewProps {
  message: string;
  onRetry?: () => void;
}

export function ErrorView({ message, onRetry }: ErrorViewProps) {
  return (
    <div className="flex flex-col items-center justify-center py-12">
      <AlertCircle className="h-16 w-16 text-red-500 mb-4" />
      <p className="text-gray-600 text-center mb-4">{message}</p>
      {onRetry && (
        <Button variant="outline" onClick={onRetry}>
          다시 시도
        </Button>
      )}
    </div>
  );
}
```

```typescript
// src/components/ui/EmptyView.tsx
import { Inbox } from 'lucide-react';

interface EmptyViewProps {
  title: string;
  description?: string;
  action?: React.ReactNode;
}

export function EmptyView({ title, description, action }: EmptyViewProps) {
  return (
    <div className="flex flex-col items-center justify-center py-12">
      <Inbox className="h-16 w-16 text-gray-400 mb-4" />
      <h3 className="text-lg font-medium text-gray-900 mb-1">{title}</h3>
      {description && (
        <p className="text-gray-500 text-center mb-4">{description}</p>
      )}
      {action}
    </div>
  );
}
```

### 2. 대시보드 화면

```typescript
// src/app/(main)/dashboard/page.tsx
'use client';

import { useRobots } from '@/lib/hooks/useRobots';
import { Card } from '@/components/ui/Card';
import { LoadingSpinner } from '@/components/ui/LoadingSpinner';
import { ErrorView } from '@/components/ui/ErrorView';
import { RobotList } from '@/components/features/robots/RobotList';
import { StatusCards } from '@/components/features/dashboard/StatusCards';
import { SearchBar } from '@/components/features/dashboard/SearchBar';

export default function DashboardPage() {
  const {
    robots,
    stats,
    isLoading,
    error,
    filter,
    setFilter,
    setSearch,
    refresh,
  } = useRobots();

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <h1 className="text-2xl font-bold text-gray-900">대시보드</h1>
      </div>

      <StatusCards stats={stats} filter={filter} onFilterChange={setFilter} />

      <Card>
        <div className="mb-4">
          <SearchBar onSearch={setSearch} />
        </div>

        {isLoading ? (
          <div className="flex justify-center py-8">
            <LoadingSpinner />
          </div>
        ) : error ? (
          <ErrorView message={error} onRetry={refresh} />
        ) : (
          <RobotList robots={robots} />
        )}
      </Card>
    </div>
  );
}
```

### 3. 기능별 컴포넌트

```typescript
// src/components/features/dashboard/StatusCards.tsx
'use client';

import { cn } from '@/lib/utils/cn';
import type { RobotStatus } from '@/types';

interface StatusCardsProps {
  stats: {
    total: number;
    online: number;
    offline: number;
    charging: number;
    error: number;
  };
  filter: RobotStatus | null;
  onFilterChange: (filter: RobotStatus | null) => void;
}

export function StatusCards({ stats, filter, onFilterChange }: StatusCardsProps) {
  const cards = [
    { key: null, label: '전체', count: stats.total, color: 'bg-gray-100' },
    { key: 'online', label: '온라인', count: stats.online, color: 'bg-green-100' },
    { key: 'offline', label: '오프라인', count: stats.offline, color: 'bg-gray-100' },
    { key: 'charging', label: '충전중', count: stats.charging, color: 'bg-orange-100' },
    { key: 'error', label: '오류', count: stats.error, color: 'bg-red-100' },
  ] as const;

  return (
    <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
      {cards.map((card) => (
        <button
          key={card.key ?? 'all'}
          onClick={() => onFilterChange(card.key)}
          className={cn(
            'p-4 rounded-lg text-left transition-all',
            card.color,
            filter === card.key
              ? 'ring-2 ring-primary-500'
              : 'hover:ring-2 hover:ring-gray-300'
          )}
        >
          <p className="text-sm text-gray-600">{card.label}</p>
          <p className="text-2xl font-bold text-gray-900">{card.count}</p>
        </button>
      ))}
    </div>
  );
}
```

```typescript
// src/components/features/robots/RobotList.tsx
import { EmptyView } from '@/components/ui/EmptyView';
import { RobotCard } from './RobotCard';
import type { Robot } from '@/types';
import Link from 'next/link';
import { Button } from '@/components/ui/Button';
import { Plus } from 'lucide-react';

interface RobotListProps {
  robots: Robot[];
}

export function RobotList({ robots }: RobotListProps) {
  if (robots.length === 0) {
    return (
      <EmptyView
        title="등록된 로봇이 없습니다"
        description="새 로봇을 등록하여 시작하세요."
        action={
          <Link href="/robots/new">
            <Button>
              <Plus className="mr-2 h-4 w-4" />
              로봇 등록
            </Button>
          </Link>
        }
      />
    );
  }

  return (
    <div className="divide-y divide-gray-200">
      {robots.map((robot) => (
        <RobotCard key={robot.id} robot={robot} />
      ))}
    </div>
  );
}
```

```typescript
// src/components/features/robots/RobotCard.tsx
import Link from 'next/link';
import { Bot, Battery, MapPin } from 'lucide-react';
import { cn } from '@/lib/utils/cn';
import type { Robot, RobotStatus } from '@/types';

interface RobotCardProps {
  robot: Robot;
}

const statusConfig: Record<RobotStatus, { label: string; color: string }> = {
  online: { label: '온라인', color: 'text-green-600 bg-green-100' },
  offline: { label: '오프라인', color: 'text-gray-600 bg-gray-100' },
  charging: { label: '충전중', color: 'text-orange-600 bg-orange-100' },
  error: { label: '오류', color: 'text-red-600 bg-red-100' },
};

export function RobotCard({ robot }: RobotCardProps) {
  const status = statusConfig[robot.status];

  return (
    <Link
      href={`/robots/${robot.id}`}
      className="flex items-center gap-4 p-4 hover:bg-gray-50 transition-colors"
    >
      <div className={cn(
        'flex items-center justify-center w-12 h-12 rounded-full',
        status.color
      )}>
        <Bot className="h-6 w-6" />
      </div>

      <div className="flex-1 min-w-0">
        <h3 className="font-medium text-gray-900 truncate">{robot.name}</h3>
        <p className="text-sm text-gray-500">{robot.model}</p>
      </div>

      <div className="flex items-center gap-4">
        {robot.battery !== undefined && (
          <div className="flex items-center gap-1 text-sm">
            <Battery className={cn(
              'h-4 w-4',
              robot.battery < 20 ? 'text-red-500' : 'text-gray-400'
            )} />
            <span className={robot.battery < 20 ? 'text-red-500' : 'text-gray-600'}>
              {robot.battery}%
            </span>
          </div>
        )}

        {robot.location?.zone && (
          <div className="flex items-center gap-1 text-sm text-gray-500">
            <MapPin className="h-4 w-4" />
            <span>{robot.location.zone}</span>
          </div>
        )}

        <span className={cn(
          'px-2 py-1 text-xs font-medium rounded-full',
          status.color
        )}>
          {status.label}
        </span>
      </div>
    </Link>
  );
}
```

### 4. 레이아웃 컴포넌트

```typescript
// src/components/layout/Header.tsx
'use client';

import Link from 'next/link';
import { Bell, User } from 'lucide-react';
import { useAuthStore } from '@/lib/stores/authStore';
import { Button } from '@/components/ui/Button';

export function Header() {
  const { user, signOut } = useAuthStore();

  return (
    <header className="h-16 border-b border-gray-200 bg-white px-6 flex items-center justify-between">
      <Link href="/dashboard" className="text-xl font-bold text-primary-600">
        My App
      </Link>

      <div className="flex items-center gap-4">
        <button className="p-2 hover:bg-gray-100 rounded-lg">
          <Bell className="h-5 w-5 text-gray-600" />
        </button>

        <div className="flex items-center gap-2">
          <div className="flex items-center justify-center w-8 h-8 bg-gray-200 rounded-full">
            <User className="h-4 w-4 text-gray-600" />
          </div>
          <span className="text-sm text-gray-700">{user?.email}</span>
        </div>

        <Button variant="ghost" size="sm" onClick={signOut}>
          로그아웃
        </Button>
      </div>
    </header>
  );
}
```

```typescript
// src/components/layout/Sidebar.tsx
'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { Home, Bot, Bell, Settings } from 'lucide-react';
import { cn } from '@/lib/utils/cn';

const menuItems = [
  { href: '/dashboard', label: '대시보드', icon: Home },
  { href: '/robots', label: '로봇 관리', icon: Bot },
  { href: '/alerts', label: '알림', icon: Bell },
  { href: '/settings', label: '설정', icon: Settings },
];

export function Sidebar() {
  const pathname = usePathname();

  return (
    <aside className="w-64 border-r border-gray-200 bg-white">
      <nav className="p-4 space-y-1">
        {menuItems.map((item) => {
          const isActive = pathname.startsWith(item.href);
          const Icon = item.icon;

          return (
            <Link
              key={item.href}
              href={item.href}
              className={cn(
                'flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors',
                isActive
                  ? 'bg-primary-50 text-primary-700'
                  : 'text-gray-700 hover:bg-gray-100'
              )}
            >
              <Icon className="h-5 w-5" />
              {item.label}
            </Link>
          );
        })}
      </nav>
    </aside>
  );
}
```

### 5. 반응형 레이아웃

```typescript
// src/app/(main)/layout.tsx
import { Header } from '@/components/layout/Header';
import { Sidebar } from '@/components/layout/Sidebar';

export default function MainLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="min-h-screen bg-gray-50">
      <Header />
      <div className="flex">
        <Sidebar />
        <main className="flex-1 p-6">
          {children}
        </main>
      </div>
    </div>
  );
}
```

---

## 산출물 템플릿

`result/development/04_ui.md`에 작성:

```markdown
# UI 구현

## 공통 컴포넌트
- [x] Button
- [x] Input
- [x] Card
- [x] LoadingSpinner
- [x] ErrorView
- [x] EmptyView

## 화면
- [x] LoginPage
- [x] RegisterPage
- [x] DashboardPage
- [x] RobotListPage
- [x] RobotDetailPage
- [x] SettingsPage

## 레이아웃
- [x] Header
- [x] Sidebar
- [x] MainLayout

## 확인 사항
- [x] 로딩 상태 표시
- [x] 에러 상태 표시
- [x] 빈 상태 표시
- [x] 반응형 레이아웃

---

## 다음 단계
→ 3.5 테스트
```

---

## 체크리스트

- [ ] 공통 UI 컴포넌트 구현
- [ ] 모든 화면 구현
- [ ] 로딩/에러/빈 상태 처리
- [ ] 네비게이션 동작
- [ ] 반응형 대응

---

## 다음 단계

→ `05_testing.md` (테스트)
